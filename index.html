<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Ihe-iti by rahulsom</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Ihe-iti</h1>
        <p>Java codegen for the IHE ITI profiles</p>

        <p class="view"><a href="https://github.com/rahulsom/ihe-iti">View the Project on GitHub <small>rahulsom/ihe-iti</small></a></p>


        <ul>
          <li><a href="https://github.com/rahulsom/ihe-iti/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/rahulsom/ihe-iti/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/rahulsom/ihe-iti">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h3>
<a name="welcome-to-ihe-iti" class="anchor" href="#welcome-to-ihe-iti"><span class="octicon octicon-link"></span></a>Welcome to IHE-ITI.</h3>

<p>This project aims to make it simpler for teams using java &amp; other jvm languages to build stuff based on IHE's IT Infrastructure profiles. </p>

<ul>
<li>Yes, they do publish WSDLs; but many of their wsdls are not even valid xml.</li>
<li>Yes, codegen is easy; but mixed content, and jaxb elements will get messy.</li>
<li>Yes there's Open eHealth; but it's an opinionated framework.</li>
</ul><p>To write a client, this is all you need.</p>

<p>If you want to build a server, you need to know enough about CXF or Metro; and use this for your interfaces. Example using CXF can be found <a href="https://github.com/rahulsom/iisd">here</a>.</p>

<h3>
<a name="writing-a-client" class="anchor" href="#writing-a-client"><span class="octicon octicon-link"></span></a>Writing a client</h3>

<p>Here's a working <em>XDS.b Document Repository</em> client:</p>

<div class="highlight highlight-groovy"><pre><span class="nd">@Grapes</span><span class="o">([</span>
  <span class="nd">@Grab</span><span class="o">(</span><span class="s1">'com.github.rahulsom:ihe-iti:0.8-SNAPSHOT'</span><span class="o">),</span>
<span class="o">])</span>

<span class="kn">import</span> <span class="nn">ihe.iti.xds_b._2007.*</span>
<span class="kn">import</span> <span class="nn">javax.xml.ws.*</span>
<span class="kn">import</span> <span class="nn">javax.xml.ws.soap.*</span>

<span class="kt">def</span> <span class="n">wsdl</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getResource</span><span class="o">(</span><span class="s1">'/iti/wsdl/XDS.b_DocumentRepository.wsdl'</span><span class="o">)</span>
<span class="n">Service</span> <span class="n">service</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DocumentRepositoryService</span><span class="o">(</span><span class="n">wsdl</span><span class="o">)</span>
<span class="kt">def</span> <span class="n">port</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="na">getDocumentRepositoryPortSoap12</span><span class="o">(</span>
    <span class="k">new</span> <span class="nf">AddressingFeature</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">),</span>
    <span class="k">new</span> <span class="nf">MTOMFeature</span><span class="o">(</span><span class="kc">true</span><span class="o">),</span>
    <span class="k">new</span> <span class="nf">RespectBindingFeature</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="o">)</span>
<span class="n">BindingProvider</span> <span class="n">bp</span> <span class="o">=</span> <span class="n">port</span>

<span class="n">bp</span><span class="o">.</span><span class="na">requestContext</span><span class="o">[</span><span class="n">BindingProvider</span><span class="o">.</span><span class="na">ENDPOINT_ADDRESS_PROPERTY</span><span class="o">]</span> <span class="o">=</span>
    <span class="s1">'http://hit-testing.nist.gov:12080/xdstools2/sim/6d39cc7d-8ec7-4547-b506-f9b5155ad211/rep/ret'</span>

<span class="kt">def</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RetrieveDocumentSetRequestType</span><span class="o">().</span>
    <span class="n">withDocumentRequest</span><span class="o">(</span>
        <span class="k">new</span> <span class="n">RetrieveDocumentSetRequestType</span><span class="o">.</span><span class="na">DocumentRequest</span><span class="o">().</span>
            <span class="n">withDocumentUniqueId</span><span class="o">(</span><span class="s1">'123'</span><span class="o">).</span>
            <span class="n">withRepositoryUniqueId</span><span class="o">(</span><span class="s1">'1.2.3.4'</span><span class="o">)</span>
    <span class="o">)</span>

<span class="n">println</span> <span class="s2">"Request created"</span>
</pre></div>

<p>Executing asynchronously with a <code>Response&lt;ReturnType&gt;</code></p>

<div class="highlight highlight-groovy"><pre><span class="kt">def</span> <span class="n">response</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="na">documentRepositoryRetrieveDocumentSetAsync</span><span class="o">(</span><span class="n">request</span><span class="o">)</span>
<span class="n">println</span> <span class="s2">"response&lt;...&gt; executed"</span>
<span class="o">...</span>
<span class="n">response</span><span class="o">.</span><span class="na">get</span><span class="o">()</span>
<span class="n">println</span> <span class="s2">"response&lt;...&gt; complete: ${response.get().registryResponse.status}"</span>
</pre></div>

<p>Executing asynchronously with a <code>AsyncHandler&lt;ReturnType&gt;</code></p>

<div class="highlight highlight-groovy"><pre><span class="kt">def</span> <span class="n">future</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="na">documentRepositoryRetrieveDocumentSetAsync</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="k">new</span> <span class="n">AsyncHandler</span><span class="o">&lt;</span><span class="n">RetrieveDocumentSetResponseType</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">handleResponse</span><span class="o">(</span><span class="n">Response</span><span class="o">&lt;</span><span class="n">RetrieveDocumentSetResponseType</span><span class="o">&gt;</span> <span class="n">res</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">println</span> <span class="s2">"future&lt;...&gt; returned: ${res.get().registryResponse.status}"</span>
  <span class="o">}</span>
<span class="o">})</span>
<span class="n">println</span> <span class="s2">"future&lt;...&gt; executed"</span>
<span class="o">...</span>
<span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">()</span>
<span class="n">println</span> <span class="s2">"future&lt;...&gt; complete: ${future.get().registryResponse.status}"</span>
</pre></div>

<p>Executing synchronously like normal people do</p>

<div class="highlight highlight-groovy"><pre><span class="kt">def</span> <span class="n">resp</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="na">documentRepositoryRetrieveDocumentSet</span><span class="o">(</span><span class="n">request</span><span class="o">)</span>
<span class="n">println</span> <span class="s2">"Sync returned: ${resp.registryResponse.status}"</span>
</pre></div>

<p>Please note that it is preferred to use the async methods in client code for performance reasons.</p>

<h3>
<a name="authors-and-contributors" class="anchor" href="#authors-and-contributors"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>Rahul Somasunderam (<a href="https://github.com/rahulsom" class="user-mention">@rahulsom</a>)</p>

<h3>
<a name="support-or-contact" class="anchor" href="#support-or-contact"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Use the <a href="https://groups.google.com/d/forum/ihe-iti">Mailing List</a>.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/rahulsom">rahulsom</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>